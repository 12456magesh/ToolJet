/* eslint-disable react/jsx-key */
import React, { useEffect } from 'react';
import { useTable } from 'react-table';
import OverlayTrigger from 'react-bootstrap/OverlayTrigger';
import Popover from 'react-bootstrap/Popover';
import { storageLayerService } from '@/_services';
// import postgrest from '@/_helpers/postgrest';

const Table = ({ selectedTable }) => {
  useEffect(() => {
    storageLayerService.findOne(selectedTable);
  }, [selectedTable]);

  const data = React.useMemo(
    () => [
      {
        name: 'Name1',
        class: 'Class1',
        age: 'Age1',
      },
      {
        name: 'Name2',
        class: 'Class2',
        age: 'Age2',
      },
      {
        name: 'Name3',
        class: 'Class3',
        age: 'Age3',
      },
    ],
    []
  );

  const columns = React.useMemo(
    () => [
      {
        Header: 'Name',
        accessor: 'name',
      },
      {
        Header: 'Class',
        accessor: 'class',
      },
      {
        Header: 'Age',
        accessor: 'age',
      },
    ],
    []
  );

  const { getTableProps, getTableBodyProps, headerGroups, rows, prepareRow } = useTable({ columns, data });

  const handleClick = (event) => {
    event.persist();
  };

  const popover = (
    <Popover id="popover-contained">
      <Popover.Content>
        <div className="row list-group-item-action cursor-pointer">
          <div className="col-auto">
            <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M1.41257 12.0293H2.02923L9.3459 4.69595L8.71257 4.07928L1.41257 11.396V12.0293ZM11.6126 3.99595L9.42923 1.81262L10.0959 1.14595C10.307 0.934838 10.5653 0.83206 10.8709 0.837616C11.1765 0.843172 11.4403 0.951505 11.6626 1.16262L12.2959 1.77928C12.5181 2.00151 12.6209 2.26262 12.6042 2.56262C12.5876 2.86262 12.4737 3.11817 12.2626 3.32928L11.6126 3.99595ZM0.962565 13.1293C0.773676 13.1293 0.615343 13.0654 0.487565 12.9376C0.359787 12.8098 0.295898 12.6515 0.295898 12.4626V11.2293C0.295898 11.1404 0.312565 11.0571 0.345898 10.9793C0.379232 10.9015 0.429232 10.8293 0.495898 10.7626L8.72923 2.51262L10.9126 4.67928L2.67923 12.9293C2.61257 12.9959 2.53757 13.046 2.45423 13.0793C2.3709 13.1126 2.28479 13.1293 2.1959 13.1293H0.962565ZM9.0459 4.37928L8.71257 4.07928L9.3459 4.69595L9.0459 4.37928Z"
                fill="#9BA3AF"
              />
            </svg>
          </div>
          <div className="col text-truncate">Edit</div>
        </div>
        <div className="row list-group-item-action cursor-pointer mt-3">
          <div className="col-auto">
            <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M4.5958 12.7461C4.22913 12.7461 3.91525 12.6156 3.65413 12.3544C3.39302 12.0933 3.26247 11.7794 3.26247 11.4128V2.24611C3.26247 1.89055 3.39302 1.58222 3.65413 1.32111C3.91525 1.06 4.22913 0.929443 4.5958 0.929443H11.7625C12.118 0.929443 12.4264 1.06 12.6875 1.32111C12.9486 1.58222 13.0791 1.89055 13.0791 2.24611V11.4128C13.0791 11.7794 12.9486 12.0933 12.6875 12.3544C12.4264 12.6156 12.118 12.7461 11.7625 12.7461H4.5958ZM4.5958 11.4128H11.7625V2.24611H4.5958V11.4128ZM2.26247 15.0628C1.90691 15.0628 1.59858 14.9322 1.33747 14.6711C1.07636 14.41 0.945801 14.1017 0.945801 13.7461V4.42944C0.945801 4.25167 1.00969 4.09889 1.13747 3.97111C1.26525 3.84333 1.42358 3.77944 1.61247 3.77944C1.80136 3.77944 1.95691 3.84333 2.07913 3.97111C2.20136 4.09889 2.26247 4.25167 2.26247 4.42944V13.7461H9.42913C9.60691 13.7461 9.75969 13.81 9.88747 13.9378C10.0152 14.0656 10.0791 14.2239 10.0791 14.4128C10.0791 14.6017 10.0152 14.7572 9.88747 14.8794C9.75969 15.0017 9.60691 15.0628 9.42913 15.0628H2.26247ZM4.5958 2.24611V11.4128V2.24611Z"
                fill="#9BA3AF"
              />
            </svg>
          </div>
          <div className="col text-truncate">Duplicate</div>
        </div>
        <div className="row list-group-item-action cursor-pointer mt-3">
          <div className="col-auto">
            <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M6.34561 6.24611C4.53449 6.24611 3.06505 5.96278 1.93727 5.39611C0.809494 4.82944 0.245605 4.185 0.245605 3.46278C0.245605 2.74055 0.806717 2.09611 1.92894 1.52944C3.05116 0.962777 4.52338 0.679443 6.34561 0.679443C8.15672 0.679443 9.62616 0.962777 10.7539 1.52944C11.8817 2.09611 12.4456 2.74055 12.4456 3.46278C12.4456 4.185 11.8845 4.82944 10.7623 5.39611C9.64005 5.96278 8.16783 6.24611 6.34561 6.24611ZM6.34561 9.77944C4.70116 9.77944 3.27338 9.52666 2.06227 9.02111C0.851161 8.51555 0.245605 7.90167 0.245605 7.17944V5.29611C0.245605 5.70722 0.434494 6.07389 0.812272 6.39611C1.19005 6.71833 1.67894 6.99333 2.27894 7.22111C2.87894 7.44889 3.53727 7.62111 4.25394 7.73778C4.97061 7.85444 5.66783 7.91278 6.34561 7.91278C7.02338 7.91278 7.72061 7.85444 8.43727 7.73778C9.15394 7.62111 9.81227 7.45166 10.4123 7.22944C11.0123 7.00722 11.5012 6.735 11.8789 6.41278C12.2567 6.09055 12.4456 5.71833 12.4456 5.29611V7.17944C12.4456 7.90167 11.8428 8.51555 10.6373 9.02111C9.43172 9.52666 8.00116 9.77944 6.34561 9.77944ZM6.34561 13.3294C4.70116 13.3294 3.27338 13.0767 2.06227 12.5711C0.851161 12.0656 0.245605 11.4517 0.245605 10.7294V8.84611C0.245605 9.25722 0.434494 9.62389 0.812272 9.94611C1.19005 10.2683 1.67894 10.5433 2.27894 10.7711C2.87894 10.9989 3.53727 11.1683 4.25394 11.2794C4.97061 11.3906 5.66783 11.4461 6.34561 11.4461C7.02338 11.4461 7.72061 11.3906 8.43727 11.2794C9.15394 11.1683 9.81227 11.0017 10.4123 10.7794C11.0123 10.5572 11.5012 10.285 11.8789 9.96278C12.2567 9.64055 12.4456 9.26833 12.4456 8.84611V10.7294C12.4456 11.4517 11.8428 12.0656 10.6373 12.5711C9.43172 13.0767 8.00116 13.3294 6.34561 13.3294Z"
                fill="#9BA3AF"
              />
            </svg>
          </div>
          <div className="col text-truncate">Make primary</div>
        </div>
        <div className="row list-group-item-action cursor-pointer mt-3">
          <div className="col-auto">
            <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M2.61247 13.2459C2.25691 13.2459 1.94858 13.1154 1.68747 12.8543C1.42636 12.5932 1.2958 12.2848 1.2958 11.9293V2.59595H1.11247C0.923579 2.59595 0.765245 2.53206 0.637467 2.40428C0.50969 2.2765 0.445801 2.11817 0.445801 1.92928C0.445801 1.74039 0.50969 1.58206 0.637467 1.45428C0.765245 1.3265 0.923579 1.26261 1.11247 1.26261H3.9958C3.9958 1.07373 4.05969 0.915392 4.18747 0.787614C4.31524 0.659836 4.47358 0.595947 4.66247 0.595947H8.02913C8.21802 0.595947 8.37913 0.662614 8.51247 0.795947C8.6458 0.929281 8.71247 1.08484 8.71247 1.26261H11.5791C11.768 1.26261 11.9264 1.3265 12.0541 1.45428C12.1819 1.58206 12.2458 1.74039 12.2458 1.92928C12.2458 2.11817 12.1819 2.2765 12.0541 2.40428C11.9264 2.53206 11.768 2.59595 11.5791 2.59595H11.3958V11.9293C11.3958 12.2848 11.2652 12.5932 11.0041 12.8543C10.743 13.1154 10.4347 13.2459 10.0791 13.2459H2.61247ZM2.61247 2.59595V11.9293H10.0791V2.59595H2.61247ZM4.3458 9.99595C4.3458 10.1515 4.40136 10.2848 4.51247 10.3959C4.62358 10.5071 4.75691 10.5626 4.91247 10.5626C5.07913 10.5626 5.21802 10.5071 5.32913 10.3959C5.44025 10.2848 5.4958 10.1515 5.4958 9.99595V4.51261C5.4958 4.34595 5.43747 4.20428 5.3208 4.08761C5.20413 3.97095 5.06802 3.91261 4.91247 3.91261C4.7458 3.91261 4.60969 3.97095 4.50413 4.08761C4.39858 4.20428 4.3458 4.34595 4.3458 4.51261V9.99595ZM7.1958 9.99595C7.1958 10.1515 7.25413 10.2848 7.3708 10.3959C7.48747 10.5071 7.62358 10.5626 7.77913 10.5626C7.9458 10.5626 8.08469 10.5071 8.1958 10.3959C8.30691 10.2848 8.36247 10.1515 8.36247 9.99595V4.51261C8.36247 4.34595 8.30413 4.20428 8.18747 4.08761C8.0708 3.97095 7.93469 3.91261 7.77913 3.91261C7.61247 3.91261 7.47358 3.97095 7.36247 4.08761C7.25136 4.20428 7.1958 4.34595 7.1958 4.51261V9.99595ZM2.61247 2.59595V11.9293V2.59595Z"
                fill="#EB1414"
              />
            </svg>
          </div>
          <div className="col text-truncate">Delete column</div>
        </div>
      </Popover.Content>
    </Popover>
  );

  return (
    <div className="table-responsive">
      <table {...getTableProps()} className="table card-table table-vcenter text-nowrap datatable">
        <thead>
          {headerGroups.map((headerGroup) => (
            <tr {...headerGroup.getHeaderGroupProps()}>
              {headerGroup.headers.map((column) => (
                <OverlayTrigger trigger="click" placement="bottom" overlay={popover}>
                  <th {...column.getHeaderProps()} className="w-1" onClick={handleClick}>
                    {column.render('Header')}
                    <svg
                      className="mt-1 float-right"
                      width="7"
                      height="4"
                      viewBox="0 0 7 4"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M2.8957 3.7666L0.779035 1.64994C0.567924 1.43882 0.517924 1.19716 0.629035 0.924935C0.740146 0.652713 0.945702 0.516602 1.2457 0.516602H5.47903C5.76792 0.516602 5.96792 0.652713 6.07904 0.924935C6.19015 1.19716 6.14015 1.43882 5.92904 1.64994L3.81237 3.7666C3.7457 3.83327 3.67348 3.88049 3.5957 3.90827C3.51792 3.93605 3.44015 3.94994 3.36237 3.94994C3.26237 3.94994 3.17626 3.93605 3.10403 3.90827C3.03181 3.88049 2.96237 3.83327 2.8957 3.7666Z"
                        fill="#576574"
                      />
                    </svg>
                  </th>
                </OverlayTrigger>
              ))}
            </tr>
          ))}
        </thead>
        <tbody {...getTableBodyProps()}>
          {rows.map((row) => {
            prepareRow(row);
            return (
              <tr {...row.getRowProps()}>
                {row.cells.map((cell) => {
                  return <td {...cell.getCellProps()}>{cell.render('Cell')}</td>;
                })}
              </tr>
            );
          })}
        </tbody>
      </table>
    </div>
  );
};

export default Table;
